I"æ<p>æ­£åˆ™è¡¨è¾¾å¼æ˜¯å¹³æ—¶å¼€å‘ä¸­ç»å¸¸ç”¨åˆ°çš„æŠ€å·§ï¼Œå¤§éƒ¨åˆ†æ—¶å€™æˆ‘ä»¬éœ€è¦çš„æ˜¯åˆ¤æ–­å­—ç¬¦ä¸²æœ‰æ²¡æœ‰å«æœ‰å›ºå®šçš„æ¨¡å¼ä¸²ï¼Œä½†æ˜¯æŸäº›åœºæ™¯ä¸‹éœ€è¦ä½¿ç”¨éè·å–åŒ¹é…ï¼Œä¸‹é¢æ ¹æ®ä¸€ç§å¸¸è§çš„æƒ…æ™¯:</p>

<p><strong>åŒ¹é…æ‰€æœ‰å«æœ‰ <code>app://page.cb/myPage?id=xxxx</code>çš„åœ°å€ï¼Œä½†æ˜¯æ’é™¤å‚æ•°ä¸­æºå¸¦<code>downgrade=true</code>çš„åœ°å€ã€‚</strong></p>

<p>å…·ä½“ç”¨å‡ ä¸ªä¾‹å­è¯´æ˜ä¸€ä¸‹:</p>

<pre><code>åŸå§‹åœ°å€: app://page.cb/myPage
åŒ¹é…ç»“æœ: noï¼Œ idä¸å­˜åœ¨

åŸå§‹åœ°å€: app://page.cb/myPage?id=123456
åŒ¹é…ç»“æœ: yes

åŸå§‹åœ°å€: app://page.cb/myPage?param=123456
åŒ¹é…ç»“æœ: no, idä¸å­˜åœ¨

åŸå§‹åœ°å€: app://page.cb/myPage?id=123456&amp;downgrade=true
åŒ¹é…ç»“æœ: no, downgradeä¸ºtrue

åŸå§‹åœ°å€: app://page.cb/myPage?id=123456&amp;downgrade=false
åŒ¹é…ç»“æœ: yes

åŸå§‹åœ°å€: app://page.cb/myPage?downgrade=false&amp;id=123456
åŒ¹é…ç»“æœ: yes

åŸå§‹åœ°å€: app://page.cb/myPage?downgrade=true&amp;id=123456
åŒ¹é…ç»“æœ: no, downgradeä¸ºtrue
</code></pre>

<p>åŒ¹é…æ‰€æœ‰ä¸å«<code>downgrade=true</code>çš„<code>app://page.cb/myPage?id=xxxx</code>åœ°å€ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„éè·å–åŒ¹é…ï¼Œä¸‹é¢ä»‹ç»éè·å–åŒ¹é…çš„ä¸¤ç§:</p>

<h4 id="pattern">(?!pattern)</h4>

<p>éè·å–åŒ¹é…ï¼Œæ­£å‘å¦å®šé¢„æŸ¥ï¼Œåœ¨ä»»ä½•ä¸åŒ¹é…patternçš„å­—ç¬¦ä¸²å¼€å§‹å¤„åŒ¹é…æŸ¥æ‰¾å­—ç¬¦ä¸²ï¼Œè¯¥åŒ¹é…ä¸éœ€è¦è·å–ä¾›ä»¥åä½¿ç”¨ã€‚ä¾‹å¦‚â€œWindows(?!95|98|NT|2000)â€èƒ½åŒ¹é…â€œWindows3.1â€ä¸­çš„â€œWindowsâ€ï¼Œä½†ä¸èƒ½åŒ¹é…â€œWindows2000â€ä¸­çš„â€œWindowsâ€ã€‚</p>

<h4 id="pattern-1">(?&lt;!pattern)</h4>

<p>éè·å–åŒ¹é…ï¼Œåå‘å¦å®šé¢„æŸ¥ï¼Œä¸æ­£å‘å¦å®šé¢„æŸ¥ç±»ä¼¼ï¼Œåªæ˜¯æ–¹å‘ç›¸åã€‚ä¾‹å¦‚â€œ(?&lt;!95|98|NT|2000)Windowsâ€èƒ½åŒ¹é…â€œ3.1Windowsâ€ä¸­çš„â€œWindowsâ€ï¼Œä½†ä¸èƒ½åŒ¹é…â€œ2000Windowsâ€ä¸­çš„â€œWindowsâ€ã€‚</p>

<p>æ ¹æ®éè·å–åŒ¹é…çš„å†™æ³•ï¼Œ æˆ‘ä»¬é‡‡ç”¨äº†æ­£å‘å¦å®šæŸ¥è¯¢ï¼Œæ­£åˆ™è¡¨è¾¾å¼å¦‚ä¸‹ï¼š</p>

<pre><code>app:\/\/page.cb\/myPage\?(((?!downgrade=true).)*id=\d+((?!downgrade=true).)*)
</code></pre>

<p>å¯¹å…¶ä¸­çš„åå‘é¢„æŸ¥éƒ¨åˆ†è¿›è¡Œåˆ†å‰²å¦‚ä¸‹ï¼š</p>

<p><span style="background-color:#B5EF79; font-weight: 700;">app:\/\/page.cb\/myPage</span><span style="background-color:#FDBE73; font-weight: 700;">\?</span>(<span style="background-color:#77C5FD; font-weight: 700;">((?!downgrade=true).)*</span><span style="background-color:#B5EF79">id=\d+</span><span style="background-color:#77C5FD; font-weight: 700;">((?!downgrade=true).)*</span>)</p>

<p>å¯ä»¥åœ¨<a href="https://regex101.com/">https://regex101.com</a> ä¸­å°è¯•åŒ¹é…ã€‚</p>

<p>åˆ†æä»¥ä¸Šæ­£åˆ™è¡¨è¾¾å¼ï¼Œå³ <code>id=\d+</code> çš„å‰åéƒ½ä¸èƒ½å«æœ‰ <code>downgrade=true</code> ï¼Œå…¶ä¸­ <code>((?!downgrade=true).)*</code> ä»é‡Œåˆ°å¤–çœ‹ï¼Œ<code>(?!downgrade=true)</code> ä»£è¡¨ä¸å«è¯¥å­—ç¬¦ä¸²ï¼Œç„¶å.ç”¨äºåŒ¹é…idå‚æ•°å‰åçš„å…¶ä»–å‚æ•°,æ­¤å¤„çš„.ä¸èƒ½é˜²æ­¢åœ¨ <code>(?!downgrade=true)</code> çš„å‰é¢ï¼Œä¼šé€ æˆå¦‚æœç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ <code>downgrade=true</code> æ—¶è¢«é—æ¼æ‰ã€‚</p>

<p>å¦‚æœéœ€è¦urlä¸­å‚æ•°éƒ¨åˆ†ï¼Œå…¶ä¸­$1å³ä¸ºå‚æ•°éƒ¨åˆ†ã€‚</p>

<p>æµ‹è¯•caseé›†åˆï¼š</p>
<pre><code>app://page.cb/myPage
app://page.cb/myPage?id=123456
app://page.cb/myPage?param=123456
app://page.cb/myPage?id=123456&amp;downgrade=true
app://page.cb/myPage?id=123456&amp;downgrade=false
app://page.cb/myPage?downgrade=false&amp;id=123456
app://page.cb/myPage?downgrade=true&amp;id=123456
</code></pre>

<blockquote>
  <p>ç”±äºå„ç§è¯­è¨€å¯¹æ­£åˆ™è¡¨è¾¾å¼æ”¯æŒç¨‹åº¦ä¸åŒï¼Œä¾‹å¦‚éè·å–åŒ¹é…ä¸­çš„åå‘å¦å®šé¢„æŸ¥åœ¨javascriptä¸­ä¸æ”¯æŒï¼Œä½†æ˜¯åœ¨php,python,javaä¸­æ˜¯æ”¯æŒçš„ï¼Œæ­£å‘å¦å®šé¢„æŸ¥åœ¨javascript,php,python,javaä¸­éƒ½æ”¯æŒï¼Œæ‰€ä»¥ä½¿ç”¨å‰ä¸€å®šè¦æ³¨æ„ï¼ŒåŒäº‹éœ€è¦è€ƒè™‘æ­£åˆ™è¡¨è¾¾å¼çš„æ€§èƒ½é—®é¢˜ã€‚</p>
</blockquote>
:ET