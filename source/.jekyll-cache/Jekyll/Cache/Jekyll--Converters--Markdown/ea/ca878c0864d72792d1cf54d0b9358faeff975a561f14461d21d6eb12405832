I"ï<p>Javaä¸­åˆ†å‰²å­—ç¬¦ä¸²ç»å¸¸ä¼šä½¿ç”¨åˆ° <code>String.split</code> ï¼Œæœ¬æ–‡ä¸­é’ˆå¯¹å•å­—ç¬¦åˆ†å‰²çš„åœºæ™¯è¿›è¡Œç®€å•è®¨è®ºï¼Œé¦–å…ˆçœ‹å‡ ä¸ªä¾‹å­:</p>

<pre><code class="language-nohighlight">"".split("=")      //ç¤ºä¾‹1
"=".split("=")     //ç¤ºä¾‹2
"==".split("=")    //ç¤ºä¾‹3
"=".split("=", 1)  //ç¤ºä¾‹4
"=".split("=", 2)  //ç¤ºä¾‹5
"=".split("=", 4)  //ç¤ºä¾‹6
"=12=".split("=")  //ç¤ºä¾‹7
"".split("=", 1)   //ç¤ºä¾‹8
</code></pre>

<p>ä»¥ä¸Šå‡ ä¸ªç¤ºä¾‹åˆ†å‰²åçš„æ•°ç»„é•¿åº¦æ˜¯å¤šå°‘å‘¢ï¼Ÿåœ¨æœ¬æ–‡å°ç»“ä¸­æœ‰ç»“æœï¼Œå¯ä»¥å¯¹æ¯”ä¸‹æ˜¯å¦å’Œæƒ³è±¡ä¸­çš„ä¸€è‡´ï¼Œæœ‰å‡ºå…¥çš„è¯å¯ä»¥ä¸€èµ·æ¥çœ‹ä¸‹æºç ã€‚</p>

<h3 id="æºç è§£æ">æºç è§£æ</h3>

<p>åŸºäºjdk8æ¥åˆ†æä¸‹ <code>String.split</code> æ–¹æ³•ï¼Œ<code>String.split</code>  æœ‰2ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«å¦‚ä¸‹ï¼š</p>

<pre><code class="language-java">public String[] split(String regex)   //æ–¹æ³•1
public String[] split(String regex, int limit) // æ–¹æ³•2
</code></pre>

<p>å…¶ä¸­æ–¹æ³•1ç›´æ¥è°ƒç”¨æ–¹æ³•2ï¼Œä¼ å…¥<code>limit=0</code></p>

<pre><code class="language-java">public String[] split(String regex) {
        return split(regex, 0);
}
</code></pre>

<p>ä¸‹é¢å…·ä½“çœ‹ä¸€ä¸‹æ–¹æ³•2çš„å®ç°</p>

<pre><code class="language-java">public String[] split(String regex, int limit) {
  // é’ˆå¯¹å•å­—ç¬¦åˆ†å‰²ï¼Œä½¿ç”¨fastpathï¼Œæ²¡æœ‰ä½¿ç”¨æ­£åˆ™java.util.regex.Pattern.splitæ–¹æ³•
  /* fastpath if the regex is a
    (1)one-char String and this character is not one of the
            RegEx's meta characters ".$|()[{^?*+\\", or
    (2)two-char String and the first char is the backslash and
            the second is not the ascii digit or ascii letter.
  */
  char ch = 0;
  if (((regex.value.length == 1 &amp;&amp;
        ".$|()[{^?*+\\".indexOf(ch = regex.charAt(0)) == -1) ||
       (regex.length() == 2 &amp;&amp;
        regex.charAt(0) == '\\' &amp;&amp;
        (((ch = regex.charAt(1))-'0')|('9'-ch)) &lt; 0 &amp;&amp;
        ((ch-'a')|('z'-ch)) &lt; 0 &amp;&amp;
        ((ch-'A')|('Z'-ch)) &lt; 0)) &amp;&amp;
      (ch &lt; Character.MIN_HIGH_SURROGATE ||
       ch &gt; Character.MAX_LOW_SURROGATE))
  {
    int off = 0;
    int next = 0;
    // limitä¸º0è¡¨ç¤ºæ²¡æœ‰æ˜¾ç¤ºæœ€å¤§åˆ†å‰²ä¸ªæ•°
    boolean limited = limit &gt; 0;
    ArrayList&lt;String&gt; list = new ArrayList&lt;&gt;();
    while ((next = indexOf(ch, off)) != -1) {
      // é•¿åº¦é™åˆ¶ä¸º1æ—¶ï¼Œè¯¥æ¡ä»¶ä¸æ»¡è¶³ï¼Œç›´æ¥è¿›å…¥elseä¸­ï¼Œä¹Ÿå³ç¤ºä¾‹4ã€8çš„æ“ä½œ
      if (!limited || list.size() &lt; limit - 1) {
        list.add(substring(off, next));
        off = next + 1;
      } else {    // last one
        //assert (list.size() == limit - 1);
        list.add(substring(off, value.length));
        off = value.length;
        break;
      }
    }
    // ç¤ºä¾‹1ä¼šè¿›å…¥çš„é€»è¾‘ï¼Œå› ä¸ºç¤ºä¾‹1åœ¨ä¸Šé¢çš„whileä¸­ä¼šç›´æ¥è·³å‡ºï¼Œoffæ—¶é»˜è®¤å€¼0
    // If no match was found, return this
    if (off == 0)
      return new String[]{this};

    //å°†æœ€åä¸€ä¸ªæ·»åŠ è¿›æ¥
    // Add remaining segment
    if (!limited || list.size() &lt; limit)
      list.add(substring(off, value.length));

    // é’ˆå¯¹limit=0çš„åœºæ™¯ï¼Œä¼šå¾ªç¯å»é™¤æœ€åä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œç¤ºä¾‹2ã€3ä¼šè§¦å‘è¯¥æ¡ä»¶
    // ä¸ºä»€ä¹ˆä¼šé’ˆå¯¹limit=0çš„è¿™ç§åœºæ™¯å»é™¤ç©ºå­—ç¬¦ä¸²ï¼Ÿæ„Ÿè§‰ä¸èƒ½ç†è§£ã€‚
    // Construct result
    int resultSize = list.size();
    if (limit == 0) {
      while (resultSize &gt; 0 &amp;&amp; list.get(resultSize - 1).length() == 0) {
        resultSize--;
      }
    }
    String[] result = new String[resultSize];
    return list.subList(0, resultSize).toArray(result);
  }
  //å¤šå­—ç¬¦ä¸²åˆ†å‰²æœ¬æ–‡ä¸è®¨è®º
  return Pattern.compile(regex).split(this, limit);
}
</code></pre>

<h3 id="å°ç»“">å°ç»“</h3>

<p>æ ¹æ®ä¸Šé¢çš„ä¾‹å­, æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œåœ¨ä¸é™å®šé•¿åº¦çš„æƒ…å†µä¸‹ï¼Œsplitåˆ†å‰²ä¼šå»é™¤æ•°æ®æœ«å°¾çš„æ‰€æœ‰ç©ºä¸²ã€‚ä»¥ä¸Šå‡ ç§åœºæ™¯çš„ç»“æœå¦‚ä¸‹:</p>

<table>
  <thead>
    <tr>
      <th>ç±»å‹</th>
      <th>ç»“æœ</th>
      <th>é•¿åº¦</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>â€â€œ.split(â€œ=â€)  //ç¤ºä¾‹1</td>
      <td>[â€â€]</td>
      <td>1</td>
    </tr>
    <tr>
      <td>â€=â€.split(â€œ=â€)  //ç¤ºä¾‹2</td>
      <td>[]</td>
      <td>0</td>
    </tr>
    <tr>
      <td>â€==â€.split(â€œ=â€)  //ç¤ºä¾‹3</td>
      <td>[]</td>
      <td>0</td>
    </tr>
    <tr>
      <td>â€=â€.split(â€œ=â€, 1)  //ç¤ºä¾‹4</td>
      <td>[â€=â€]</td>
      <td>1</td>
    </tr>
    <tr>
      <td>â€=â€.split(â€œ=â€, 2)  //ç¤ºä¾‹5</td>
      <td>[â€â€, â€œâ€]</td>
      <td>2</td>
    </tr>
    <tr>
      <td>â€=â€.split(â€œ=â€, 4)  //ç¤ºä¾‹6</td>
      <td>[â€â€, â€œâ€]</td>
      <td>2</td>
    </tr>
    <tr>
      <td>â€œ=12=â€.split(â€œ=â€)  //ç¤ºä¾‹7</td>
      <td>[â€â€, â€œ12â€]</td>
      <td>2</td>
    </tr>
    <tr>
      <td>â€â€œ.split(â€œ=â€, 1)  //ç¤ºä¾‹8</td>
      <td>[â€â€]</td>
      <td>1</td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>å¦‚æœ‰ä»»ä½•çŸ¥è¯†äº§æƒã€ç‰ˆæƒé—®é¢˜æˆ–ç†è®ºé”™è¯¯ï¼Œè¿˜è¯·æŒ‡æ­£ã€‚</p>

  <p>è½¬è½½è¯·æ³¨æ˜åŸä½œè€…åŠä»¥ä¸Šä¿¡æ¯ã€‚</p>
</blockquote>
:ET